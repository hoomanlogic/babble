!function(e){"use strict";var t=function(e){return e.hasOwnProperty("toString")?e.toString():e},n=function(e,t,n){var s=0,a=t.pos;"undefined"!=typeof n&&null!==n&&(s=n.pos+n.text.length);for(var r=0,o=null,r=0;r<e.length;r++)if(s<=e[r].pos&&e[r].pos<a)o=e[r];else if(e[r].pos>=a)break;return o};e.getTokenModifier=n;var s=function(e,t){if(0===e.length||e[e.length-1].pos<t.pos)e.push(t);else for(var n=0;n<e.length;n++){if(e[n].pos>t.pos){e.splice(n,0,t);break}if(e[n].pos===t.pos&&e[n].len<t.len){e.splice(n,1,t);break}}};e.insertToken=s;var a=function(e,t,n){this.input=e,this.tokens=t,this.preParsedResults=n||null};a.prototype={toString:function(){for(var e=this.input,n=0;n<this.tokens.length;n++)e=e.slice(0,this.tokens[n].pos)+t(this.tokens[n].value)+e.slice(this.tokens[n].pos+this.tokens[n].text.length);return e}};var r=function(e,t,n,s,a,r){this.value=e,this.kind=t,this.pos=n,this.text=s,this.tokens=a||[],this.certainty=r||0},o=function(e,t){if(!this.hasOwnProperty("name")||"string"!=typeof this.name||!this.hasOwnProperty("parse")||"function"!=typeof this.parse||"function Object() { [native code] }"===this.constructor.toString())throw new Error('BaseTranslator must be inheritied and properties set for "name" and "parse"');if("undefined"==typeof i[this.name])throw new Error('"'+this.name+'" must be registered before it is instantiated');if(this.locale=t||i[this.name].defaultLocale,-1===i[this.name].supportedLocales.indexOf(this.locale))throw new Error('Locale "'+this.locale+'" is not supported by "'+this.name+'"');this.onTranslate=e||null,this.hasOwnProperty("assistants")||(this.assistants=[])};o.prototype={listen:function(e,t,n,s){if("string"==typeof e&&document&&document.getElementById&&(e=document.getElementById(e)),t=t||"input",n=n||this.onTranslate,e.addEventListener)e.addEventListener(t,this.translate.bind(this,{speaker:e,locale:s,onTranslate:n}));else if(e.attachEvent)e.attachEvent("on"+t,this.translate.bind(this,{speaker:e,locale:s,onTranslate:n}));else if("undefined"!=typeof e["on"+t])e["on"+t]=this.translate.bind(this,{speaker:e,locale:s,onTranslate:n});else{if("undefined"==typeof e[t])throw new Error("Could not find an appropriate event to bind to");e[t]=this.translate.bind(this,{speaker:e,locale:s,onTranslate:n})}},translate:function(){for(var e=null,t={locale:this.locale,onTranslate:null,speaker:null},n=0;n<arguments.length;n++)if("string"==typeof arguments[n])arguments[n].length<6&&-1!==i[this.name].supportedLocales.indexOf(arguments[n])?t.locale=arguments[n]:null===e&&(e=arguments[n]);else if("object"==typeof arguments[n])if("undefined"!=typeof arguments[n].target&&"undefined"!=typeof arguments[n].target.value)e=arguments[n].target.value;else for(var s in arguments[n])arguments[n].hasOwnProperty(s)&&(t[s]=arguments[n][s]);else"function"==typeof arguments[n]&&(t.onTranslate=arguments[n]);if(e){var r=this.parse(e,t.locale);return null!==t.onTranslate&&t.onTranslate(r,t.speaker),this.onTranslate&&this.onTranslate(r,t.speaker),r}return new a(e,[])},passToAssistants:function(e,t){for(var n={},s=0;s<this.assistants.length;s++)n[this.assistants[s]]=u(this.assistants[s]).parse(e,t);return n}},e.ParsedResult=a,e.BaseTranslator=o,e.Token=r;var i={},l=function(e,t,n,s){i[e]={instance:null,defaultLocale:n,supportedLocales:s},i[e].instance=new t};e.register=l;var u=function(e,t){if(t=t||i[e].instance.locale,-1===i[e].supportedLocales.indexOf(t))throw new Error('Locale "'+this.locale+'" is not supported by "'+e+'"');return i[e].locale=t||i[e].instance.locale,i[e].instance};e.get=u;var h=function(e,t){var n=null,s=null,a=null;if(arguments.length<3||"function"!=typeof arguments[arguments.length-1])throw new TypeError("Unexpected number of arguments");a=arguments[arguments.length-1],arguments.length>3&&(n=arguments[2]),arguments.length>4&&(s=arguments[3]);var r=u(e,s);r.listen(t,n,a,s)};e.assign=h}("undefined"==typeof exports?this.babble=this.babble||{}:exports);
!function(t){"use strict";var e=function(){for(var t=this.preParsedOutput||this.input,e=0;e<this.tokens.length;e++)t=t.replace(this.tokens[e].text,n(this.tokens[e].value));return t},n=function(t){return t.hasOwnProperty("toString")?t.toString():t},s=function(t,e){if(0===t.length||t[t.length-1].pos<e.pos)t.push(e);else for(var n=0;n<t.length;n++){if(t[n].pos>e.pos){t.splice(n,0,e);break}if(t[n].pos===e.pos&&t[n].len<e.len){t.splice(n,1,e);break}}},r=function(t,n,s,r){this.input=t,this.tokens=n,this.preParsedOutput=s||null,this.preParsedResults=r||null,this.digify=e.bind(this)},a=function(t,e){if(!this.hasOwnProperty("name")||"string"!=typeof this.name||!this.hasOwnProperty("parse")||"function"!=typeof this.parse||"function Object() { [native code] }"===this.constructor.toString())throw new Error('BaseTranslator must be inheritied and properties set for "name" and "parse"');if("undefined"==typeof i[this.name])throw new Error('"'+this.name+'" must be registered before it is instantiated');if(this.locale=e||i[this.name].defaultLocale,-1===i[this.name].supportedLocales.indexOf(this.locale))throw new Error('Locale "'+this.locale+'" is not supported by "'+this.name+'"');this.onTranslate=t||null,this.hasOwnProperty("assistants")||(this.assistants=[])};a.prototype={listen:function(t,e,n){if("string"==typeof t&&document&&document.getElementById&&(t=document.getElementById(t)),e=e||"input",n=n||this.onTranslate,t.addEventListener)t.addEventListener(e,this.translate.bind(this,t,n));else if(t.attachEvent)t.attachEvent("on"+e,this.translate.bind(this,t,n));else if("undefined"!=typeof t["on"+e])t["on"+e]=this.translate.bind(this,t,n);else{if("undefined"==typeof t[e])throw new Error("Could not find an appropriate event to bind to");t[e]=this.translate.bind(this,t,n)}},translate:function(){var t=arguments.length,e=this.locale;-1!==i[this.name].supportedLocales.indexOf(arguments[arguments.length-1])&&(t=arguments.length-1,e=arguments[t]);var n="",s=t-1;if("string"==typeof arguments[s]?n=arguments[s]:arguments[s]&&arguments[s].target&&arguments[s].target.value&&(n=arguments[s].target.value),n){var r=this.parse(n,e);return arguments.length>2&&"function"==typeof arguments[1]?arguments[1](r,arguments[0]):this.onTranslate&&arguments.length>1&&"string"!=typeof arguments[0]&&this.onTranslate(r,arguments[0]),r}},passToAssistants:function(t,e){for(var n=t,s={},r=0;r<this.assistants.length;r++)s[this.assistants[r]]=u(this.assistants[r]).parse(n,e),n=s[this.assistants[r]].digify();return{preParsedOutput:n,preParsedResults:s}}},t.ParsedResult=r,t.BaseTranslator=a;var i={},o=function(t,e,n,s){i[t]={instance:null,defaultLocale:n,supportedLocales:s},i[t].instance=new e};t.register=o;var u=function(t,e){if(e=e||i[t].instance.locale,-1===i[t].supportedLocales.indexOf(e))throw new Error('Locale "'+this.locale+'" is not supported by "'+t+'"');return i[t].locale=e||i[t].instance.locale,i[t].instance};t.get=u;var l=function(t,e){var n=null,s=null,r=null;if(arguments.length<3||"function"!=typeof arguments[arguments.length-1])throw new TypeError("Unexpected number of arguments");r=arguments[arguments.length-1],arguments.length>3&&(n=arguments[2]),arguments.length>4&&(s=arguments[3]);var a=u(t,s);a.listen(e,n,r)};t.assign=l,t.insertMatch=s,t.theSpaceBetween=function(t,e,n,s){return t.slice(e+n,s)}}("undefined"==typeof exports?this.babble=this.babble||{}:exports);